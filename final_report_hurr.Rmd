---
title: "Hurricane Final Report"
author: "Yuanming Leng, Biyao Zhang, Chen Xu, Xihao Cao"
date: "11/20/2021"
output:
  html_document: default
  pdf_document: 
    latex_engine: xelatex
---

```{r setup, include=FALSE, echo=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE)
pacman::p_load("tidyverse","ggplot2","dplyr", "maps", "drat","hurricaneexposuredata","hurricaneexposure","weathermetrics","scales","sp","gstat","ggplot2","ggforce","tmap")
```

```{r,warning=FALSE}
source("map_counties_j.R")
source("data clean.R")
source("visualization function.R")
source("buoy_kriging.R")
source("hurricane_krige.R")
source("rain_kriging.R")
```




## Movement Track
Hurricane Ike was a powerful tropical hurricane that swept through portions of the Greater Antilles and Northern America in September 2008. The origins of Hurricane Ike can be traced back to a well-defined tropical wave first identified by the National Hurricane Center (NHC) near the western coast of Africa on August 28. After a period of development, Ike made its first landfall on Inagua in the Bahamas at 13:00 UTC on September 7 with winds of 125 mph (201 km/h). After one day, Ike made its second landfall on Cuba with a Category 4 intensity. Then, at 0700 UTC on September 13, Ike made its third landfall on Galveston Island in Texas (N29.4, W-95.01), with a Category 2 intensity and a maximum wind speed of 110 mph (180 km/h). Then Ike moved northward after its landfall on Texas and weakened to a tropical storm status.

```{r, fig.width=10}
mapps_Ike$trackmap
mapps_Ike$expos
```
\
\

## Loss and Damage:
Ike is the seventh-costliest hurricane in United States history until now, it caused over $38 billion damage and 214 casualties. And due to the intensity of the storm, Texas closed many of its chemical plants and oil refineries which caused many indirect economy losses in the mean time.
\
\


## Buoys selected
Our project will only focus on the conditions of Ike when it made its landfall in Texas. We selected 8 Buoys from the NOAA database to analyze Ike. All 8 buoys are located near the center of the landfall location, the maximum distance between two buoys is around 60 miles, and the minimum distance is around 25 miles. The selected Buoys IDs are: GRRT2(29.302 N 94.896 W), 42043(28.982 N 94.899 W), GNJT2(29.357 N 94.725 W), 42035(29.232 N 94.413 W), EPTT2(29.481 N 94.917 W), MGPT2(29.682 N 94.985 W), CLLT2(29.563 N 95.067 W), RLOT2(29.515 N 94.513 W).
\
\

```{r,fig.width=10}
mapps_Ike$buoymap
```

## EDA of Buoys data
Firstly we use the buoys data to get the gust wind speed vs time and wind speed vs time. Notice that the timeline is from 6:00 on 2008-09-11 to 18:00 on 2008-09-15 which contains the time Ike made its landfall(September 13th). Each line represents the wind speed variation at one specific buoy, and there are 8 buoys, thus 8 lines in total. As we can see, the 8 lines share the same overall shape in both graphs, where the wind speeds reaches their maximum around 6:00 on 2008/9/13 which is very close to the landfall time of Ike(7:00 UTC). Meanwhile, we can see that the wind speeds decrease under 10m/s after 6:00 on 2008/9/14, which was also close to the time Ike left the landfall neighborhood. If we compare the information of Ike in the Hurricane Exposure with these graphs, we can see that they share almost the same timeline, which is what we want.

```{r,fig.width=10}
wind_speed_tsp(get_result())
gust_wind_speed_tsp(get_result())
```

\
\
Secondly, we use the buoys data to get the sea level pressure vs. time time series plot. Notice that the timeline is from 6:00 on 2008-09-11 to 18:00 on 2008-09-15 which contains the time Ike made its landfall(September 13th at 7:00AM). Each line represents the sea level pressure(hPa) at one specific buoy, and there are 5 buoys recorded the data, thus 5 lines in total.

Sea level pressure – the same metric that we all use to guess if the weather is getting better or worse by seeing if the pressure is rising or falling – is already a common test of strength used in hurricanes and storm systems around the globe.

Generally, the lower the central pressure, the stronger the storm. The lowest pressure in a hurricane is always found at its center, or in its eye.

We can see from the plot that the sea level pressure recorded by buoy reaches to its lowest level around September 13th at 7:00AM, when Ike landfall. Hurricane Ike was a Category 2 on the Saffir–Simpson hurricane wind scale (SSHWS) but had a pressure of around 950 hPa when it arrived on the Texas coast. This was the third-lowest pressure for a landfalling Category 2 since 1900. Ike caused about $38 billion in damage, according to the National Hurricane Center. In 2009, Ike ranked as the second-costliest hurricane to make landfall in the United States. Since then, more damaging storms have made landfall, but Ike remains as the sixth-most-damaging hurricane. As we can conclude that sea level pressure may be another useful indicator of Hurricane Damage Potential besides wind speed and rainfall. 
```{r, echo=F, fig.width=10}
press_tsp(get_result())
```
\
\





## EDA of Hurricane_Package data
The following four graphs illustrate the data of Ike in the Hurricane package.
\
### This graph shows the wind speed variation of Ike along its tract. As we can see that the maximum speed Ike reached in the U.S. is around 45m/s at the landfall area, which is consistent with the peak value of our wind speed graph above. 
```{r, fig.width=10}
#wind speed(m/s)
mapps_Ike$wmap
#wind duration(minutes)
mapps_Ike$wdmp
```
\


### The second graph we have is the map of tornados event that were caused by Ike. Although tornado is another another topic, we can get some useful information from its distribution. Notice that most of the exposed area also encountered higher amount of rainfall, but we could not find a clear relationship between the wind speed of Ike and the tornado events.
```{r, fig.width=10}
# tornado situation
mapps_Ike$tornado
```
\


### The third figure here is flood event exposed when Ike transits with Ike's track and the fourth figure is the rainfall map when Ike transit in 2008. In addition to high winds, hurricanes threaten coastal areas with their heavy rains. All tropical cyclones can produce widespread torrential rains, which cause massive flooding and trigger landslides and debris flows. Flash flooding, a rapid rise in water levels, can occur quickly due to intense rainfall over a relatively short period of time. As we can see from these two figures, the area has major rainfall and the area where flood events occur are overlap.
```{r,fig.width=10}
#flood event
mapps_Ike$flood
#rainfall
mapps_Ike$rmap
```
\



## Variogram
|
|
|
|

## Using data from hurricane exposure data package: 
```{r,fig.width=10}
# Same direction VGM
plot(v, v_fit_same)
# Vary direction VGM
plot(lzn.dir, lzndir.fit, as.table = TRUE)
```


## Wind speed along track prediction using kriging:
```{r, fig.width=10,warning=FALSE}
hurri_predicted
hurri_map
```


## Rainfall along track:
```{r,warning=FALSE,fig.width=10}
# check variogram and covariance
op <- par(mfrow = c(1, 2))
h <- seq(0, 50, length = 100)
plot(vgm_rain,vgm_rain_fit) #plot(v,v_f)
plot(vv,vv_fit,main="Directional Variogram") #,as.table=TRUE) 
```




## Using Buoy's data from NOAA:
```{r}
par(mfrow = c(1,2))
#buoy vgm
plot(semivariog, v_fit_buoy, xlim = c(0,0.45),ylim = c(-10,100))
predict_wspd
```


```{r,fig.width=10}
#predict landfall point wind speed using buoy's data
buoy_kriging_map
```


## Conclusion
A.  Although buoys collects sea-based data the hurricane package collects land-based data, after compare their wind speed, rainfall graphs, we find that they basically share the same overall shapes, and their key information at the landfall point, ex: maximum wind speed, wind duration, and rainfall amount, are very close. Thus, we can conclude that the buoys we selected are able to describe Ike's overall condition when it made its landfall. 

B. After plotting the hurricane_exposure package data, we find that the flood and rainfall value basically share the same distribution along the Ike's movement tract, which points out that they are highly correlated. However, as for the distribution and value of wind speed and tornado, we cannot find an noticeable relation between them, which suggests that they are not highly correlated.

3. 


4. 
\
\
\

## Tips:
Based on the data, conclusiion, and previous record, we have the following advice for people who may encounter a hurricane.
Tips for residents:

1. Never go outside the protection of your home or shelter before there is confirmation that the storm has passed the area. The eye of the storm could create a temporary and deceptive lull, with high winds still approaching

2. Use a portable radio to listen to important storm updates, information and instructions.

3. Stay inside and keep away from all windows, skylights and glass doors. Go to a safe area, such as an interior room, closet or downstairs bathroom.

\
\

## Reference:
1. Buoys data: https://www.ndbc.noaa.gov/measdes.shtml

2. Wikipedia: https://en.wikipedia.org/wiki/Hurricane_Ike#United_States

3. Sea level pressure: https://weather.com/storms/hurricane/news/2020-01-29-hurricane-surface-pressure-damage-potential-wind
